<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      @page {
        size: A4 landscape;
        margin: 20px;
      }
      body {
        font-family: Arial, sans-serif;
        font-size: 12px;
        margin: 0;
        padding: 10px;
      }
      .company-name {
        text-align: center;
        font-weight: bold;
        font-size: 16px;
        margin-bottom: 2px;
      }
      .company-description {
        text-align: center;
        font-size: 11px;
        margin-bottom: 4px;
      }
      .company-phones {
        text-align: center;
        font-size: 10px;
      }
      .info-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        border: 1px solid black;
      }
      .info-table td {
        padding: 5px;
        vertical-align: top;
      }
      .left-col {
        width: 70%;
        border-right: 1px solid black;
      }
      .right-col {
        width: 30%;
      }
      .equipos-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        border: 1px solid black;
      }
      .equipos-table th, .equipos-table td {
        border: 1px solid black;
        padding: 5px;
      }
      .equipos-table th {
        text-align: center;
      }
      .equipo-cell {
        text-align: left;
        vertical-align: middle;
      }
      .repair-cell, .price-cell, .obs-cell {
        text-align: center;
        vertical-align: middle;
      }
    </style>
  </head>
  <body>
    tttttttttttttt
    <div class="company-name">${company.name}</div>
    <div class="company-description">${company.description}</div>
    <div class="company-phones">${company.phones}</div>

    <table class="info-table">
      <tr>
        <td class="left-col">
          <strong>Cliente:</strong> ${client_name} &nbsp;&nbsp;&nbsp;
          <strong>Fecha:</strong> ${receipt_date}<br>
          <strong>Celular:</strong> ${phone_1}${phone_2 ? ' / ' + phone_2 : ''}
        </td>
        <td class="right-col">
          <strong>Técnico Responsable:</strong> ${company.ResponsibleTechnician}<br>
          <strong>N° Nota de Venta:</strong> ${numTicket}
        </td>
      </tr>
    </table>

    <table class="equipos-table">
      <thead>
        <tr>
          <th>Equipo</th>
          <th>Reparación</th>
          <th>Precio</th>
          <th>Observaciones</th>
        </tr>
      </thead>
      <tbody>
        ${repairs.map(equipo => {
          const rowspan = equipo.reparaciones.length;
          return equipo.reparaciones.map((rep, index) => `
            <tr>
              ${index === 0 ? `<td class="equipo-cell" rowspan="${rowspan}">${equipo.nombre}</td>` : ''}
              <td class="repair-cell">${rep.detalle}</td>
              <td class="price-cell">${company.CurrencySymbol}${rep.precio}</td>
              ${index === 0 ? `<td class="obs-cell" rowspan="${rowspan}">${equipo.observaciones || ''}</td>` : ''}
            </tr>
          `).join('');
        }).join('')}
      </tbody>
    </table>
  </body>
</html>
